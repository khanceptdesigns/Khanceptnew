<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KhanceptDesigns – Home</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body {margin:0;font-family:"Poppins",sans-serif;background:#f4f4f4;color:#222;}
header{padding:40px 20px;text-align:center;background:#000;color:white;}
header h1{margin:0;font-size:3rem;font-weight:700;}
nav{background:#000;padding:15px 0;text-align:center;}
nav ul{list-style:none;margin:0;padding:0;}
nav ul li{display:inline-block;margin:0 20px;}
nav ul li a{color:white;text-decoration:none;font-weight:600;font-size:1.1rem;transition:0.3s;}
nav ul li a:hover{color:#aaa;}
nav ul li a.active{color:#1E90FF;font-weight:700;} /* Active tab */

.container{width:95%;max-width:1400px;margin:40px auto;}
.section-title{font-size:1.8rem;font-weight:700;margin-bottom:20px;}
.category-section{margin-bottom:50px;}
.product-row{
  display:flex;
  overflow-x:auto;
  gap:15px;
  padding-bottom:10px;
  scrollbar-width: thin;
  scrollbar-color: rgba(0,0,0,0.3) transparent;
}
.product-row::-webkit-scrollbar{height:8px;}
.product-row::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.3);border-radius:4px;}
.product-row::-webkit-scrollbar-track{background:transparent;}
.product-card{flex:0 0 200px;background:white;border-radius:12px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,0.1);transition:0.3s;}
.product-card:hover{transform:translateY(-5px);}
.product-card img{width:100%;height:180px;object-fit:contain;background:#f9f9f9;}
.product-info{padding:10px;}
.product-info h3{margin:0;font-size:1rem;font-weight:600;}
.product-info .price{margin:5px 0;font-weight:700;color:#d40000;}
.product-info a{display:inline-block;margin-top:10px;padding:6px 12px;background:#000;color:white;text-decoration:none;border-radius:8px;transition:0.3s;font-size:0.9rem;}
.product-info a:hover{background:#333;}
.search-container{width:100%;max-width:500px;margin:20px auto;}
#searchBar{width:100%;padding:10px 15px;font-size:1rem;border-radius:10px;border:2px solid #ccc;outline:none;}
#searchBar:focus{border-color:#000;}
</style>
</head>
<body>

<header>
<h1>KhanceptDesigns</h1>
<p>Shop by Category</p>
</header>

<nav>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="featured.html">Featured</a></li>
    <li><a href="sale.html">Sale</a></li>
    <li><a href="#contact">Contact</a></li>
  </ul>
</nav>

<div class="search-container">
<input type="text" id="searchBar" placeholder="Search all products...">
</div>

<div class="container" id="categoryContainer">
<!-- Categories will be dynamically inserted here -->
</div>

<footer style="text-align:center;padding:25px;background:#111;color:white;">
© 2025 KhanceptDesigns – All Rights Reserved
</footer>

<script>
// Load products from localStorage
const allProducts = JSON.parse(localStorage.getItem("allProducts")) || [];

// Group products by category (default to "Products" if missing)
const categories = {};
allProducts.forEach(prod => {
  const category = prod.category || "Products";
  if(!categories[category]) categories[category] = [];
  categories[category].push(prod);
});

const categoryContainer = document.getElementById("categoryContainer");

function displayCategories(productsByCategory){
  categoryContainer.innerHTML = "";
  for(const category in productsByCategory){
    const products = productsByCategory[category];
    const section = document.createElement("div");
    section.classList.add("category-section");
    const categoryTitle = category || "Products"; // Default to "Products"
    section.innerHTML = `<h2 class="section-title">${categoryTitle}</h2>
      <div class="product-row">
        ${products.map(prod => `
          <div class="product-card">
            <img src="${prod.img}" alt="${prod.name}">
            <div class="product-info">
              <h3>${prod.name}</h3>
              <p class="price">
                ${prod.oldPrice ? `<span style="text-decoration:line-through;color:#777;">$${prod.oldPrice}</span> ` : ""}$${prod.salePrice}
              </p>
              <a href="${prod.link}">Buy Now</a>
            </div>
          </div>
        `).join("")}
      </div>`;
    categoryContainer.appendChild(section);
  }
}

// Initial display
displayCategories(categories);

// Live search
document.getElementById("searchBar").addEventListener("keyup", function(){
  const filter = this.value.toLowerCase();
  const filtered = allProducts.filter(prod =>
    prod.name.toLowerCase().includes(filter) || prod.desc.toLowerCase().includes(filter)
  );

  // Regroup filtered products by category
  const filteredCategories = {};
  filtered.forEach(prod => {
    const category = prod.category || "Products";
    if(!filteredCategories[category]) filteredCategories[category] = [];
    filteredCategories[category].push(prod);
  });

  displayCategories(filteredCategories);
});

// Highlight active navigation tab
const navLinks = document.querySelectorAll("nav ul li a");
const currentPage = window.location.pathname.split("/").pop();
navLinks.forEach(link => {
  const linkPage = link.getAttribute("href");
  if(linkPage === currentPage || (currentPage === "" && linkPage === "index.html")){
    link.classList.add("active");
  } else {
    link.classList.remove("active");
  }

  link.addEventListener("click", () => {
    navLinks.forEach(l => l.classList.remove("active"));
    link.classList.add("active");
  });
});
</script>

</body>
</html>
